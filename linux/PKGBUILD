# Description: Linux kernel, sources and modules
# URL:         
# Maintainer:  Emmett1, emmett1 dot 2miligrams at gmail dot com
# Depends on:  elfutils mkinitramfs openssl linux-firmware

pkgname=linux
pkgver=5.15.6
pkgrel=1
arch=('x86_64')
source=(https://www.kernel.org/pub/linux/kernel/v5.x/linux-$pkgver.tar.xz
        config)

build() {
	cd linux-$pkgver

#	make mrproper
	
	cp -f $srcdir/config ./.config
	make menuconfig
	make bzImage -j3
	make modules -j3
}

package() {
        cd linux-$pkgver

	make INSTALL_MOD_PATH=$pkgdir modules_install

	mkdir -p $pkgdir/boot

	cp arch/x86/boot/bzImage $pkgdir/boot/vmlinuz-drunk
	cp .config $pkgdir/boot/config-drunk
	echo $kernver > $pkgdir/lib/modules/KERNELVERSION
}
