# Description: Libraries and utilities for loading kernel modules
# URL:         https://git.kernel.org/?p=utils/kernel/kmod/kmod.git;a=summary
# Maintainer:  Emmett1, emmett1 dot 2miligrams at gmail dot com
# Depends on:  

pkgname=kmod
pkgver=29
pkgrel=1
arch=('x86_64')
source=(https://www.kernel.org/pub/linux/utils/kernel/$pkgname/$pkgname-$pkgver.tar.xz)

build() {
        cd $pkgname-$pkgver

        ./configure --prefix=/usr          \
                    --bindir=/bin          \
                    --sysconfdir=/etc      \
                    --with-rootlibdir=/lib \
                    --with-xz              \
                    --with-zlib
        make
}

package() {
	cd $pkgname-$pkgver
        make DESTDIR=$pkgdir install

        mkdir -p $pkgdir/sbin
        for target in depmod insmod lsmod modinfo modprobe rmmod; do
          ln -sfv ../bin/kmod $pkgdir/sbin/$target
        done

        ln -sfv kmod $pkgdir/bin/lsmod
}
